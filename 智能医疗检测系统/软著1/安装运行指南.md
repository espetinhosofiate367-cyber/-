# 动态逐帧检测系统 - 安装运行指南

## 目录
1. [系统要求](#系统要求)
2. [环境准备](#环境准备)
3. [依赖安装](#依赖安装)
4. [系统安装](#系统安装)
5. [运行指南](#运行指南)
6. [功能使用](#功能使用)
7. [常见问题](#常见问题)
8. [故障排除](#故障排除)

---

## 系统要求

### 硬件要求
- **处理器**: Intel i5 或 AMD Ryzen 5 及以上
- **内存**: 8GB RAM (推荐 16GB)
- **存储空间**: 至少 2GB 可用空间
- **显示器**: 1920x1080 分辨率或更高
- **网络**: 用于下载依赖包 (安装时需要)

### 软件要求
- **操作系统**: 
  - Windows 10/11 (64位)
  - macOS 10.14 或更高版本
  - Linux Ubuntu 18.04 或更高版本
- **Python版本**: 3.8 - 3.11 (推荐 3.9)

---

## 环境准备

### 1. Python 安装

#### Windows 系统
1. 访问 [Python官网](https://www.python.org/downloads/)
2. 下载 Python 3.9.x 版本
3. 运行安装程序，**务必勾选 "Add Python to PATH"**
4. 验证安装：
```cmd
python --version
pip --version
```

#### macOS 系统
```bash
# 使用 Homebrew 安装 (推荐)
brew install python@3.9

# 或使用官方安装包
# 从 python.org 下载并安装
```

#### Linux 系统
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3.9 python3.9-pip python3.9-venv

# CentOS/RHEL
sudo yum install python39 python39-pip
```

### 2. 虚拟环境创建 (推荐)

```bash
# 创建虚拟环境
python -m venv detection_env

# 激活虚拟环境
# Windows:
detection_env\Scripts\activate

# macOS/Linux:
detection_env\Scripts\activate
```

---

## 依赖安装

### 1. 自动安装 (推荐)

在项目根目录下执行：
```bash
pip install -r requirements.txt
```

### 2. 手动安装

如果自动安装失败，可以逐个安装：

```bash
# 核心依赖
pip install numpy==1.24.3
pip install pandas==2.0.3
pip install matplotlib==3.7.2
pip install scipy==1.11.1

# 机器学习
pip install scikit-learn==1.3.0
pip install scikit-image==0.21.0

# 数据可视化
pip install seaborn==0.12.2
pip install Pillow==10.0.0

# 优化算法
pip install bayesian-optimization==1.4.3

# 统计分析
pip install statsmodels==0.14.0

# 其他工具
pip install tqdm==4.65.0
pip install openpyxl==3.1.2
pip install xlrd==2.0.1
pip install xlwt==1.3.0
pip install pyserial==3.5
pip install numba==0.57.1
pip install joblib==1.3.1
```

### 3. 验证安装

运行验证脚本：
```python
# 创建 verify_installation.py
import sys
import importlib

required_packages = [
    'numpy', 'pandas', 'matplotlib', 'scipy',
    'sklearn', 'skimage', 'seaborn', 'PIL',
    'bayes_opt', 'statsmodels', 'tqdm',
    'openpyxl', 'serial', 'numba', 'joblib'
]

print("验证依赖包安装...")
for package in required_packages:
    try:
        importlib.import_module(package)
        print(f"✓ {package} - 已安装")
    except ImportError:
        print(f"✗ {package} - 未安装")

print("验证完成！")
```

---

## 系统安装

### 1. 获取源代码

将提供的源代码文件放置在同一目录下：
```
detection_system/
├── main_detection_app.py
├── modern_detection_gui.py
├── enhanced_detection_system.py
├── statistical_analysis.py
├── 统计.py
├── requirements.txt
└── README.md
```

### 2. 目录结构验证

确保所有文件都在正确位置：
```bash
# Windows
dir

# macOS/Linux
ls -la
```

### 3. 权限设置 (Linux/macOS)

```bash
chmod +x *.py
```

---

## 运行指南

### 1. 启动主程序

#### 方法一：直接运行主程序
```bash
python main_detection_app.py
```

#### 方法二：运行现代化GUI
```bash
python modern_detection_gui.py
```

#### 方法三：运行统计分析模块
```bash
python 统计.py
```

### 2. 首次运行检查

系统首次运行时会自动检查：
- 依赖包完整性
- 系统兼容性
- 必要目录创建

如果出现错误，请参考 [故障排除](#故障排除) 部分。

---

## 功能使用

### 1. 主界面功能

启动 `main_detection_app.py` 后，您将看到主界面：

- **启动主系统**: 打开完整的检测分析界面
- **快速检测**: 对单个文件进行快速分析
- **批量分析**: 处理多个数据文件
- **系统设置**: 配置系统参数
- **帮助文档**: 查看使用说明

### 2. 检测系统使用

#### 数据导入
1. 点击 "文件" → "导入数据"
2. 选择 CSV 格式的数据文件
3. 系统自动验证数据格式

#### 参数调整
- **检测阈值**: 调整结节检测的敏感度
- **平滑参数**: 控制数据平滑程度
- **聚类数量**: 设置GMM模型的聚类数

#### 实时检测
1. 导入数据后，系统自动开始检测
2. 实时显示检测结果和统计信息
3. 可以随时调整参数查看效果

### 3. 统计分析功能

#### 趋势分析
- 自动分析数据变化趋势
- 显示线性拟合结果
- 提供统计显著性检验

#### 异常检测
- 多算法融合异常检测
- 实时标记异常数据点
- 提供异常原因分析

#### 报告生成
1. 点击 "分析" → "生成报告"
2. 选择报告格式 (PDF/Excel)
3. 自动生成详细分析报告

### 4. 数据导出

#### 支持格式
- **CSV**: 原始数据和检测结果
- **Excel**: 详细分析报告
- **PNG/PDF**: 可视化图表
- **GIF**: 动态检测过程

#### 导出步骤
1. 完成分析后，点击 "导出"
2. 选择导出格式和保存位置
3. 系统自动生成并保存文件

---

## 常见问题

### Q1: 程序启动时出现 "ModuleNotFoundError"
**A**: 这表示某些依赖包未正确安装。请重新运行：
```bash
pip install -r requirements.txt
```

### Q2: GUI界面显示异常或字体乱码
**A**: 这通常是字体配置问题：
```python
# 在代码中添加字体配置
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['SimHei', 'Arial Unicode MS']
plt.rcParams['axes.unicode_minus'] = False
```

### Q3: 数据导入失败
**A**: 检查数据格式：
- 确保是 CSV 格式
- 检查数据编码 (推荐 UTF-8)
- 验证数据列名和格式

### Q4: 检测结果不准确
**A**: 尝试调整参数：
- 降低检测阈值提高敏感度
- 增加平滑参数减少噪声
- 调整聚类数量适应数据特征

### Q5: 程序运行缓慢
**A**: 优化建议：
- 减少数据量进行测试
- 关闭不必要的可视化
- 增加系统内存
- 使用SSD存储

---

## 故障排除

### 1. 安装问题

#### Python版本不兼容
```bash
# 检查Python版本
python --version

# 如果版本过低，请升级Python
```

#### pip安装失败
```bash
# 升级pip
python -m pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

#### 虚拟环境问题
```bash
# 删除现有环境
rm -rf detection_env

# 重新创建
python -m venv detection_env
source detection_env/bin/activate  # Linux/macOS
detection_env\Scripts\activate     # Windows
```

### 2. 运行时问题

#### 内存不足
- 减少处理的数据量
- 关闭其他应用程序
- 增加虚拟内存

#### 文件权限问题 (Linux/macOS)
```bash
chmod 755 *.py
sudo chown $USER:$USER *.py
```

#### 端口占用 (如果使用串口功能)
```bash
# 查看端口使用情况
lsof -i :端口号

# 结束占用进程
kill -9 进程ID
```

### 3. 性能优化

#### 加速建议
1. **使用SSD存储**: 提高文件读写速度
2. **增加内存**: 减少磁盘交换
3. **关闭实时可视化**: 在大数据处理时
4. **使用多核处理**: 启用并行计算

#### 内存优化
```python
# 在处理大数据时，可以分批处理
chunk_size = 1000
for chunk in pd.read_csv('large_file.csv', chunksize=chunk_size):
    process_chunk(chunk)
```

---

## 技术支持

### 联系方式
- **技术文档**: 查看系统内置帮助
- **问题反馈**: 通过系统反馈功能提交
- **更新检查**: 定期检查系统更新

### 日志文件
系统运行日志保存在：
- Windows: `%APPDATA%\detection_system\logs\`
- macOS: `~/Library/Application Support/detection_system/logs/`
- Linux: `~/.detection_system/logs/`

### 配置文件
系统配置保存在：
- `config.json`: 主要配置参数
- `user_preferences.json`: 用户偏好设置

---

## 更新说明

### 版本检查
系统会自动检查更新，也可以手动检查：
1. 启动主程序
2. 点击 "帮助" → "检查更新"
3. 按提示进行更新

### 数据备份
更新前请备份重要数据：
- 配置文件
- 分析结果
- 自定义参数

---

**注意**: 如果在安装或使用过程中遇到问题，请首先查看本指南的故障排除部分。大多数问题都可以通过正确的环境配置和依赖安装来解决。